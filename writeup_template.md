## Traffic Sign Recognition 

#### Overview

The traffic sign project is about building a model based on the convolutional neural network concept in deep learning. Training, Validating and Testing the traffic sign classifier model is based on the German traffic signs dataset. 

#### The Project Steps:
* Load the data set (see below for links to the project data set)
* Explore, summarize and visualize the data set
* Design, train and test a model architecture
* Use the model to make predictions on new images
* Analyze the softmax probabilities of the new images
* Summarize the results with a written report 

You're reading it! and here is a link to my [project code](https://github.com/AhmedMYassin/Traffic-Sign-Classifier/blob/master/Traffic_Sign_Classifier.ipynb)

### 1. Data Set Summary & Exploration

These are the statistics of the traffic signs data set:

* The size of training set is 34799 + (34799*2) = 10397 // 34799*2 are generated by input images rotation
* The size of the validation set is 4410
* The size of test set is 12630
* The shape of a traffic sign image is [32, 32, 3]
* The number of unique classes/labels in the data set is 43

Here is an exploratory visualization of the data set.

![alt text](https://github.com/AhmedMYassin/Traffic-Sign-Classifier/blob/master/examples/plot_hist.png)

### 2. Design and Test a Model Architecture

#### Preprocessing: 
In this phase we convert the input images to grayscale and apply CLAHE "Contrast Limited Adaptive Histogram Equalization". The input images are also normalized ((value/255) - 0.5).

| Before			        |     After	        					| 
|:---------------------:|:---------------------------------------------:| 
| ![alt text](https://github.com/AhmedMYassin/Traffic-Sign-Classifier/blob/master/examples/dataset_ex_before.png)         		| ![alt text](https://github.com/AhmedMYassin/Traffic-Sign-Classifier/blob/master/examples/dataset_ex_After.png)   							| 

#### Augmentation
In this phase, the input images are rotated by 20 and -20 degrees and added to the training set.

| CW			        |     CCW	        					| 
|:---------------------:|:---------------------------------------------:| 
| ![alt text](https://github.com/AhmedMYassin/Traffic-Sign-Classifier/blob/master/examples/dataset_ro_after_cw.png)         		| ![alt text](https://github.com/AhmedMYassin/Traffic-Sign-Classifier/blob/master/examples/dataset_ro_after_ccw.png)   							| 

#### Model Archeticture:

| Layer         		|     Description	        					| 
|:---------------------:|:---------------------------------------------:| 
| Input         		| 32x32x1 Gray image   							| 
| Convolution 5x5     	| 1x1 stride, valid padding, outputs 28x28x10 	|
| RELU					|												|
| Max pooling	      	| 2x2 stride,  outputs 14x14x10 				|
| Convolution 5x5     	| 1x1 stride, valid padding, outputs 10x10x22 	|
| RELU					|												|
| Max pooling	      	| 2x2 stride,  outputs 5x5x22 				| 
| Flatten     	| 5x5x22 to 550 neurons 	|
| Fully Connected     	| input 550, output 350 	|
| RELU					|												|
| Dropout					|	0.8											|
| Fully Connected     	| input 350, output 43 |	 


### 3. Model Training

To train the model, I used the LeNet model for 10 epochs using 0.0055 learning rate, 150 Batch size and Adam optimizer instead of gradient descent.

| EPOCH         		|     Validation Accuracy	        					|      Training Accuracy	        					| 
|:---------------------:|:---------------------------------------------:|:---------------------------------------------:| 
| 1	      	| 0.932 				| 0.959 				|
| 2	      	| 0.945 				| 0.978 				|
| 3	      	| 0.955 				| 0.981 				|
| 4	      	| 0.950 				| 0.980 				|
| 5	      	| 0.950 				| 0.982 				|
| 6	      	| 0.951 				| 0.986 				|
| 7	      	| 0.950 				| 0.977 				|
| 8	      	| 0.957 				| 0.988 				|
| 9	      	| 0.948 				| 0.982 				|
| 10	      	| 0.959 				| 0.987 				|

### 4. Model Tuning
At the begining the accuracy wasn't good (below 0.85) so I tried to use the inception model to train the model but it was so complicated and always tends to overfitting because of the large number of feature maps and the final number of input neurons to the fully connected NN. I got back the LeNet model and changed the batch size to be smaller (150) and increased the number of epochs to be 10. Tuning the number of feature maps was the key to increase the accuracy.

My final model results were:
* training set accuracy of 0.987
* validation set accuracy of 0.959 
* test set accuracy of 0.941
 

#### Test a Model on New Images

I have downloaded the German traffic sign dataset and I select 5 signs randomly from the dataset in each run, Here you can check the selected images after processing in the latest run:

![alt text](https://github.com/AhmedMYassin/Traffic-Sign-Classifier/blob/master/examples/DE_image0.png) ![alt text](https://github.com/AhmedMYassin/Traffic-Sign-Classifier/blob/master/examples/DE_image1.png) ![alt text](https://github.com/AhmedMYassin/Traffic-Sign-Classifier/blob/master/examples/DE_image2.png) 
![alt text](https://github.com/AhmedMYassin/Traffic-Sign-Classifier/blob/master/examples/DE_image3.png) ![alt text](https://github.com/AhmedMYassin/Traffic-Sign-Classifier/blob/master/examples/DE_image4.png)

After testing the selected images the accuaracy was 1.0 which is a perfect prediction. The accuracy isn't always 1.0, sometimes it's 0.8 which means that one of the images was missed

Here are the results of the prediction:

| Image			        |     Prediction	        					| 
|:---------------------:|:---------------------------------------------:| 
| Double curve      		| Double curve   									| 
| Turn right ahead     			| Turn right ahead 										|
| Double curve					| Double curve											|
| Bicycles crossing	      		| Bicycles crossing					 				|
| Pedestrians			| Pedestrians      							|

Using softmax probability gives better insight about the model prediction accuaracy, Here are the probability of the top 5 probabilities.

| Probability         	|     Prediction	        					| 
|:---------------------:|:---------------------------------------------:| 
| .60         			| Stop sign   									| 
| .20     				| U-turn 										|
| .05					| Yield											|
| .04	      			| Bumpy Road					 				|
| .01				    | Slippery Road      							|


### Visualizing the Neural Network
#### Visualizing the feature maps in the neural network is very helpful. This image is the effect of each of the 22 feature maps on the input image
#### Input Image
![alt text](https://github.com/AhmedMYassin/Traffic-Sign-Classifier/blob/master/examples/visualization_image.png)
#### Feature Map Effect
![alt text](https://github.com/AhmedMYassin/Traffic-Sign-Classifier/blob/master/examples/visualization.png)



